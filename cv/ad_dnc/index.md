# 構造学習と密度比
# 10章「疎構造学習による異常検知」
- [参考:https://ide-research.net/papers/2016_Iwanami_Ide.pdf](https://ide-research.net/papers/2016_Iwanami_Ide.pdf)
- 異常現象に対して、それぞれの変数がどのくらい寄与しているかをしらべるのは単純ベイズ法のような極端な方法以外はあまりない
- 変数同士の依存関係が崩れることを検知して異常度を計算する手法について考える
- 10.1節「変数間の関係に基づく異常の判定」
  - エンジンのように出力が常時変わる物理量はホテリング法では平均からのズレしか見れず向いていない
  - 変数の値ではなく、変数の関係性から異常を判定するには、関係の表現の方法と、異常度の計算方法が重要である。
- 10.2節「変数同士の関係の表し方」
  - 変数同士の関係は，変数を頂点，関係の有無を辺とするグラフで表現できる
  - ノイズや誤差に強くするために，変数の間の関係を「統計的独立性」に対応させるのが良い
  - 最も簡単な，2つの変数の関係のみに注目する(3つ以上の関連は無視)考え方でグラフと確率分布を結びつけるモデルを「**対マルコフネットワーク**(**対マルコフ場**)」という。
  - グラフ構造をデータから学習する「**構造学習**」は，データから確率分布を学習する問題に帰着できる
  - 疑似相関は，3変数の散布図で，輪切りして相関を見ると無関係であることがわかる。
- 10.3節「正規分布に基づく対マルコフグラフ」
  - 確率分布p(x)として多変量正規分布を想定した「マルコフグラフモデル」を，「**ガウス型グラフィカルモデル**」と呼ぶ。
  - x_1とx_2が統計的に独立であるためには，x_3~x_Mである時のx_1,x_2がそれぞれに関する部分の積としてかける必要がある
  - 精度行列Λの(i,j)成分が0の時，他の変数を固定した時，相関がないことが言えて，逆の場合は「**直接相関**」があるという。
  - **偏相関係数**rは，直接相関だけを選んだ時の相関係数。
  - ガウス型グラフィカルモデルで，直接相関が0でも共分散行列Σの(i,j)成分が0でない時，「**間接相関**」があるという。
  - 精度行列は直接相関を表し，共分散行列は直接相関と間接相関の和を表す。
- 10.4節「疎なガウス型グラフィカルモデルの学習」
  - 構造学習の目的は，直接相関の構造を作ること
  - 解釈のしやすいグラフは，本質的な関係だけを捉えた「**疎な**(sparse)」グラフが良い。
  - 疎なガウス型グラフィカルモデルの学習のスタンダードは「**グラフィカルラッソ**(graphical lasso)」です。
  - 精度行列Λを疎に作ることが難しいという問題を解決するため，疎な解を好む事前分布「**ラプラス分布**(Laplace distribution)」を与える。
  - 他の変数を固定して1つの変数に対し勾配法を適用する「**座標降下法**」を用いる
  - 行や列をかたまりとして適用する場合は「**ブロック座標降下法**」という。
- 10.5節「素構造学習に基づく異常度の計算」
  - M次元標本の異常度をM個の変数に対してここに計算する分析手法を「**外れ値解析**」と呼ぶ。
  - 疎構造学習の結果は異常検知モデルの解釈可能性という観点で重要な役割を果たす。
  - その結果を直接求める必要がない場合もあり，確率密度の比がわかれば異常度がわかる